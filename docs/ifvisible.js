!function(t,e){if("object"==typeof exports&&"object"==typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var i=e();for(var s in i)("object"==typeof exports?exports:t)[s]=i[s]}}(window,function(){return function(t){var e={};function i(s){if(e[s])return e[s].exports;var n=e[s]={i:s,l:!1,exports:{}};return t[s].call(n.exports,n,n.exports,i),n.l=!0,n.exports}return i.m=t,i.c=e,i.d=function(t,e,s){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:s})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var s=Object.create(null);if(i.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)i.d(s,n,function(e){return t[e]}.bind(null,n));return s},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=0)}({"./node_modules/webpack/buildin/global.js":
/*!***********************************!*\
  !*** (webpack)/buildin/global.js ***!
  \***********************************/
/*! no static exports found */function(t,e){var i;i=function(){return this}();try{i=i||new Function("return this")()}catch(t){"object"==typeof window&&(i=window)}t.exports=i},"./src/Events.ts":
/*!***********************!*\
  !*** ./src/Events.ts ***!
  \***********************/
/*! no static exports found */function(t,e,i){"use strict";var s;Object.defineProperty(e,"__esModule",{value:!0}),function(t){const e={};let i;t.attach=function(t,i){e[t]||(e[t]=[]),e[t].push(i)},t.fire=function(t,i=[]){e[t]&&e[t].forEach(t=>{t(...i)})},t.remove=function(t,i){i||delete e[t],e[t]&&(e[t]=e[t].filter(t=>i!==t))},t.dom=function(t,e,s){return i||(i=t.addEventListener?function(t,e,i){return t.addEventListener(e,i,!1)}:"function"==typeof t.attachEvent?function(t,e,i){return t.attachEvent("on"+e,i,!1)}:function(t,e,i){return t["on"+e]=i}),i(t,e,s)}}(s=e.Events||(e.Events={})),e.default=s},"./src/Timer.ts":
/*!**********************!*\
  !*** ./src/Timer.ts ***!
  \**********************/
/*! no static exports found */function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const s=i(/*! ./ifvisible */"./src/ifvisible.ts");e.default=class{constructor(t,e,i){this.ifvisible=t,this.seconds=e,this.callback=i,this.stopped=!1,this.start(),this.ifvisible.on("statusChanged",t=>{!1===this.stopped&&(t.status===s.STATUS_ACTIVE?this.start():this.pause())})}start(){this.stopped=!1,clearInterval(this.token),this.token=setInterval(this.callback,1e3*this.seconds)}stop(){this.stopped=!0,clearInterval(this.token)}resume(){this.start()}pause(){this.stop()}}},"./src/ifvisible.ts":
/*!**************************!*\
  !*** ./src/ifvisible.ts ***!
  \**************************/
/*! no static exports found */function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const s=i(/*! ./Events */"./src/Events.ts"),n=i(/*! ./Timer */"./src/Timer.ts");let o;e.STATUS_ACTIVE="active",e.STATUS_IDLE="idle",e.STATUS_HIDDEN="hidden";let r=void 0;e.IE=function(){let t=3,e=document.createElement("div"),i=e.getElementsByTagName("i");for(;e.innerHTML="\x3c!--[if gt IE "+ ++t+"]><i></i><![endif]--\x3e",i[0];);return t>4?t:void 0}();e.IfVisible=class{constructor(t,i){if(this.root=t,this.doc=i,this.status=e.STATUS_ACTIVE,this.VERSION="2.0.11",this.timers=[],this.idleTime=3e4,this.isLegacyModeOn=!1,void 0!==this.doc.hidden?(o="hidden",r="visibilitychange"):void 0!==this.doc.mozHidden?(o="mozHidden",r="mozvisibilitychange"):void 0!==this.doc.msHidden?(o="msHidden",r="msvisibilitychange"):void 0!==this.doc.webkitHidden&&(o="webkitHidden",r="webkitvisibilitychange"),void 0===o)this.legacyMode();else{const t=()=>{this.doc[o]?this.blur():this.focus()};t(),s.default.dom(this.doc,r,t)}this.startIdleTimer(),this.trackIdleStatus()}legacyMode(){if(this.isLegacyModeOn)return;let t="blur";e.IE<9&&(t="focusout"),s.default.dom(this.root,t,()=>(console.log("blurred"),this.blur())),s.default.dom(this.root,"focus",()=>this.focus()),this.isLegacyModeOn=!0}startIdleTimer(t){t instanceof MouseEvent&&0===t.movementX&&0===t.movementY||(this.timers.map(clearTimeout),this.timers.length=0,this.status===e.STATUS_IDLE&&this.wakeup(),this.idleStartedTime=+new Date,this.timers.push(setTimeout(()=>{if(this.status===e.STATUS_ACTIVE||this.status===e.STATUS_HIDDEN)return this.idle()},this.idleTime)))}trackIdleStatus(){s.default.dom(this.doc,"mousemove",this.startIdleTimer.bind(this)),s.default.dom(this.doc,"mousedown",this.startIdleTimer.bind(this)),s.default.dom(this.doc,"keyup",this.startIdleTimer.bind(this)),s.default.dom(this.doc,"touchstart",this.startIdleTimer.bind(this)),s.default.dom(this.root,"scroll",this.startIdleTimer.bind(this)),this.focus(this.startIdleTimer.bind(this))}on(t,e){return s.default.attach(t,e),this}off(t,e){return s.default.remove(t,e),this}setIdleDuration(t){return this.idleTime=1e3*t,this.startIdleTimer(),this}getIdleDuration(){return this.idleTime}getIdleInfo(){let t,i=+new Date;if(this.status===e.STATUS_IDLE)t={isIdle:!0,idleFor:i-this.idleStartedTime,timeLeft:0,timeLeftPer:100};else{let e=this.idleStartedTime+this.idleTime-i;t={isIdle:!1,idleFor:i-this.idleStartedTime,timeLeft:e,timeLeftPer:parseFloat((100-100*e/this.idleTime).toFixed(2))}}return t}idle(t){return t?this.on("idle",t):(this.status=e.STATUS_IDLE,s.default.fire("idle"),s.default.fire("statusChanged",[{status:this.status}])),this}blur(t){return t?this.on("blur",t):(this.status=e.STATUS_HIDDEN,s.default.fire("blur"),s.default.fire("statusChanged",[{status:this.status}])),this}focus(t){return t?this.on("focus",t):this.status!==e.STATUS_ACTIVE&&(this.status=e.STATUS_ACTIVE,s.default.fire("focus"),s.default.fire("wakeup"),s.default.fire("statusChanged",[{status:this.status}])),this}wakeup(t){return t?this.on("wakeup",t):this.status!==e.STATUS_ACTIVE&&(this.status=e.STATUS_ACTIVE,s.default.fire("wakeup"),s.default.fire("statusChanged",[{status:this.status}])),this}onEvery(t,e){return new n.default(this,t,e)}now(t){return void 0!==t?this.status===t:this.status===e.STATUS_ACTIVE}}},"./src/main.ts":
/*!*********************!*\
  !*** ./src/main.ts ***!
  \*********************/
/*! no static exports found */function(t,e,i){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0});const s=i(/*! ./ifvisible */"./src/ifvisible.ts"),n="object"==typeof self&&self.self===self&&self||"object"==typeof t&&t.global===t&&t||this;e.ifvisible=new s.IfVisible(n,document)}).call(this,i(/*! ./../node_modules/webpack/buildin/global.js */"./node_modules/webpack/buildin/global.js"))},0:
/*!***************************!*\
  !*** multi ./src/main.ts ***!
  \***************************/
/*! no static exports found */function(t,e,i){t.exports=i(/*! ./src/main.ts */"./src/main.ts")}})});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vd2VicGFjay91bml2ZXJzYWxNb2R1bGVEZWZpbml0aW9uIiwid2VicGFjazovLy93ZWJwYWNrL2Jvb3RzdHJhcCIsIndlYnBhY2s6Ly8vKHdlYnBhY2spL2J1aWxkaW4vZ2xvYmFsLmpzIiwid2VicGFjazovLy8uL3NyYy9FdmVudHMudHMiLCJ3ZWJwYWNrOi8vLy4vc3JjL1RpbWVyLnRzIiwid2VicGFjazovLy8uL3NyYy9pZnZpc2libGUudHMiLCJ3ZWJwYWNrOi8vLy4vc3JjL21haW4udHMiXSwibmFtZXMiOlsicm9vdCIsImZhY3RvcnkiLCJleHBvcnRzIiwibW9kdWxlIiwiZGVmaW5lIiwiYW1kIiwiYSIsImkiLCJ3aW5kb3ciLCJpbnN0YWxsZWRNb2R1bGVzIiwiX193ZWJwYWNrX3JlcXVpcmVfXyIsIm1vZHVsZUlkIiwibCIsIm1vZHVsZXMiLCJjYWxsIiwibSIsImMiLCJkIiwibmFtZSIsImdldHRlciIsIm8iLCJPYmplY3QiLCJkZWZpbmVQcm9wZXJ0eSIsImVudW1lcmFibGUiLCJnZXQiLCJyIiwiU3ltYm9sIiwidG9TdHJpbmdUYWciLCJ2YWx1ZSIsInQiLCJtb2RlIiwiX19lc01vZHVsZSIsIm5zIiwiY3JlYXRlIiwia2V5IiwiYmluZCIsIm4iLCJvYmplY3QiLCJwcm9wZXJ0eSIsInByb3RvdHlwZSIsImhhc093blByb3BlcnR5IiwicCIsInMiLCJnIiwidGhpcyIsIkZ1bmN0aW9uIiwiZSIsIkV2ZW50cyIsInN0b3JlIiwic2V0TGlzdGVuZXIiLCJhdHRhY2giLCJldmVudCIsImNhbGxiYWNrIiwicHVzaCIsImZpcmUiLCJhcmdzIiwiZm9yRWFjaCIsInJlbW92ZSIsImZpbHRlciIsInNhdmVkQ2FsbGJhY2siLCJkb20iLCJlbGVtZW50IiwiYWRkRXZlbnRMaXN0ZW5lciIsImVsIiwiZXYiLCJmbiIsImF0dGFjaEV2ZW50IiwiZGVmYXVsdCIsImlmdmlzaWJsZV8xIiwiW29iamVjdCBPYmplY3RdIiwiaWZ2aXNpYmxlIiwic2Vjb25kcyIsInN0b3BwZWQiLCJzdGFydCIsIm9uIiwiZGF0YSIsInN0YXR1cyIsIlNUQVRVU19BQ1RJVkUiLCJwYXVzZSIsImNsZWFySW50ZXJ2YWwiLCJ0b2tlbiIsInNldEludGVydmFsIiwic3RvcCIsIkV2ZW50c18xIiwiVGltZXJfMSIsIkRPQ19ISURERU4iLCJTVEFUVVNfSURMRSIsIlNUQVRVU19ISURERU4iLCJWSVNJQklMSVRZX0NIQU5HRV9FVkVOVCIsIklFIiwidiIsImRpdiIsImRvY3VtZW50IiwiY3JlYXRlRWxlbWVudCIsImFsbCIsImdldEVsZW1lbnRzQnlUYWdOYW1lIiwiaW5uZXJIVE1MIiwidW5kZWYiLCJJZlZpc2libGUiLCJkb2MiLCJWRVJTSU9OIiwidGltZXJzIiwiaWRsZVRpbWUiLCJpc0xlZ2FjeU1vZGVPbiIsImhpZGRlbiIsImxlZ2FjeU1vZGUiLCJ0cmFja0NoYW5nZSIsImJsdXIiLCJmb2N1cyIsInN0YXJ0SWRsZVRpbWVyIiwidHJhY2tJZGxlU3RhdHVzIiwiQkxVUl9FVkVOVCIsImNvbnNvbGUiLCJsb2ciLCJNb3VzZUV2ZW50IiwibW92ZW1lbnRYIiwibW92ZW1lbnRZIiwibWFwIiwiY2xlYXJUaW1lb3V0IiwibGVuZ3RoIiwid2FrZXVwIiwiaWRsZVN0YXJ0ZWRUaW1lIiwiRGF0ZSIsInNldFRpbWVvdXQiLCJpZGxlIiwicmVzIiwibm93IiwiaXNJZGxlIiwiaWRsZUZvciIsInRpbWVMZWZ0IiwidGltZUxlZnRQZXIiLCJwYXJzZUZsb2F0IiwidG9GaXhlZCIsImNoZWNrIiwic2VsZiIsImdsb2JhbCJdLCJtYXBwaW5ncyI6IkNBQUEsU0FBQUEsRUFBQUMsR0FDQSxvQkFBQUMsU0FBQSxpQkFBQUMsT0FDQUEsT0FBQUQsUUFBQUQsU0FDQSxzQkFBQUcsZUFBQUMsSUFDQUQsT0FBQSxHQUFBSCxPQUNBLENBQ0EsSUFBQUssRUFBQUwsSUFDQSxRQUFBTSxLQUFBRCxHQUFBLGlCQUFBSixnQkFBQUYsR0FBQU8sR0FBQUQsRUFBQUMsSUFQQSxDQVNDQyxPQUFBLFdBQ0QsbUJDVEEsSUFBQUMsRUFBQSxHQUdBLFNBQUFDLEVBQUFDLEdBR0EsR0FBQUYsRUFBQUUsR0FDQSxPQUFBRixFQUFBRSxHQUFBVCxRQUdBLElBQUFDLEVBQUFNLEVBQUFFLEdBQUEsQ0FDQUosRUFBQUksRUFDQUMsR0FBQSxFQUNBVixRQUFBLElBVUEsT0FOQVcsRUFBQUYsR0FBQUcsS0FBQVgsRUFBQUQsUUFBQUMsSUFBQUQsUUFBQVEsR0FHQVAsRUFBQVMsR0FBQSxFQUdBVCxFQUFBRCxRQTBEQSxPQXJEQVEsRUFBQUssRUFBQUYsRUFHQUgsRUFBQU0sRUFBQVAsRUFHQUMsRUFBQU8sRUFBQSxTQUFBZixFQUFBZ0IsRUFBQUMsR0FDQVQsRUFBQVUsRUFBQWxCLEVBQUFnQixJQUNBRyxPQUFBQyxlQUFBcEIsRUFBQWdCLEVBQUEsQ0FBMENLLFlBQUEsRUFBQUMsSUFBQUwsS0FLMUNULEVBQUFlLEVBQUEsU0FBQXZCLEdBQ0Esb0JBQUF3QixlQUFBQyxhQUNBTixPQUFBQyxlQUFBcEIsRUFBQXdCLE9BQUFDLFlBQUEsQ0FBd0RDLE1BQUEsV0FFeERQLE9BQUFDLGVBQUFwQixFQUFBLGNBQWlEMEIsT0FBQSxLQVFqRGxCLEVBQUFtQixFQUFBLFNBQUFELEVBQUFFLEdBRUEsR0FEQSxFQUFBQSxJQUFBRixFQUFBbEIsRUFBQWtCLElBQ0EsRUFBQUUsRUFBQSxPQUFBRixFQUNBLEtBQUFFLEdBQUEsaUJBQUFGLFFBQUFHLFdBQUEsT0FBQUgsRUFDQSxJQUFBSSxFQUFBWCxPQUFBWSxPQUFBLE1BR0EsR0FGQXZCLEVBQUFlLEVBQUFPLEdBQ0FYLE9BQUFDLGVBQUFVLEVBQUEsV0FBeUNULFlBQUEsRUFBQUssVUFDekMsRUFBQUUsR0FBQSxpQkFBQUYsRUFBQSxRQUFBTSxLQUFBTixFQUFBbEIsRUFBQU8sRUFBQWUsRUFBQUUsRUFBQSxTQUFBQSxHQUFnSCxPQUFBTixFQUFBTSxJQUFxQkMsS0FBQSxLQUFBRCxJQUNySSxPQUFBRixHQUlBdEIsRUFBQTBCLEVBQUEsU0FBQWpDLEdBQ0EsSUFBQWdCLEVBQUFoQixLQUFBNEIsV0FDQSxXQUEyQixPQUFBNUIsRUFBQSxTQUMzQixXQUFpQyxPQUFBQSxHQUVqQyxPQURBTyxFQUFBTyxFQUFBRSxFQUFBLElBQUFBLEdBQ0FBLEdBSUFULEVBQUFVLEVBQUEsU0FBQWlCLEVBQUFDLEdBQXNELE9BQUFqQixPQUFBa0IsVUFBQUMsZUFBQTFCLEtBQUF1QixFQUFBQyxJQUd0RDVCLEVBQUErQixFQUFBLEdBSUEvQixJQUFBZ0MsRUFBQTs7Ozs0Q0NsRkEsSUFBQUMsRUFHQUEsRUFBQSxXQUNBLE9BQUFDLEtBREEsR0FJQSxJQUVBRCxLQUFBLElBQUFFLFNBQUEsaUJBQ0MsTUFBQUMsR0FFRCxpQkFBQXRDLFNBQUFtQyxFQUFBbkMsUUFPQUwsRUFBQUQsUUFBQXlDOzs7OzJEQ25CQSxJQUFpQkksbURBQWpCLFNBQWlCQSxHQUNiLE1BQU1DLEVBQVEsR0FDZCxJQUFJQyxFQUVZRixFQUFBRyxPQUFoQixTQUF1QkMsRUFBZUMsR0FDN0JKLEVBQU1HLEtBQ1BILEVBQU1HLEdBQVMsSUFFbkJILEVBQU1HLEdBQU9FLEtBQUtELElBR05MLEVBQUFPLEtBQWhCLFNBQXFCSCxFQUFlSSxFQUFPLElBQ25DUCxFQUFNRyxJQUNOSCxFQUFNRyxHQUFPSyxRQUFTSixJQUNsQkEsS0FBWUcsTUFLUlIsRUFBQVUsT0FBaEIsU0FBdUJOLEVBQWVDLEdBQzdCQSxVQUNNSixFQUFNRyxHQUViSCxFQUFNRyxLQUNOSCxFQUFNRyxHQUFTSCxFQUFNRyxHQUFPTyxPQUFRQyxHQUN6QlAsSUFBYU8sS0FLaEJaLEVBQUFhLElBQWhCLFNBQW9CQyxFQUFjVixFQUFlQyxHQWdCN0MsT0FmS0gsSUFFR0EsRUFEQVksRUFBUUMsaUJBQ00sU0FBVUMsRUFBSUMsRUFBSUMsR0FDNUIsT0FBT0YsRUFBR0QsaUJBQWlCRSxFQUFJQyxHQUFJLElBRUUsbUJBQTNCSixFQUFxQixZQUNyQixTQUFVRSxFQUFJQyxFQUFJQyxHQUM1QixPQUFPRixFQUFHRyxZQUFZLEtBQU9GLEVBQUlDLEdBQUksSUFHM0IsU0FBVUYsRUFBSUMsRUFBSUMsR0FDNUIsT0FBT0YsRUFBRyxLQUFPQyxHQUFNQyxJQUk1QmhCLEVBQVlZLEVBQVNWLEVBQU9DLElBOUMzQyxDQUFpQkwsRUFBQTdDLEVBQUE2QyxTQUFBN0MsRUFBQTZDLE9BQU0sS0FrRHZCN0MsRUFBQWlFLFFBQWVwQjs7Ozs0R0NsRGYsTUFBQXFCLEVBQUExRCxvQkFBQSxzQkFFQVIsRUFBQWlFLFFBQUEsTUFJSUUsWUFBb0JDLEVBQ0FDLEVBQ0FuQixHQUZBUixLQUFBMEIsWUFDQTFCLEtBQUEyQixVQUNBM0IsS0FBQVEsV0FKcEJSLEtBQUE0QixTQUFtQixFQUtmNUIsS0FBSzZCLFFBRUw3QixLQUFLMEIsVUFBVUksR0FBRyxnQkFBa0JDLEtBQ1gsSUFBakIvQixLQUFLNEIsVUFDREcsRUFBS0MsU0FBV1IsRUFBQVMsY0FDaEJqQyxLQUFLNkIsUUFFTDdCLEtBQUtrQyxXQU1iVCxRQUNKekIsS0FBSzRCLFNBQVUsRUFDZk8sY0FBY25DLEtBQUtvQyxPQUNuQnBDLEtBQUtvQyxNQUFRQyxZQUFZckMsS0FBS1EsU0FBeUIsSUFBZlIsS0FBSzJCLFNBRzFDRixPQUNIekIsS0FBSzRCLFNBQVUsRUFDZk8sY0FBY25DLEtBQUtvQyxPQUdoQlgsU0FDSHpCLEtBQUs2QixRQUdGSixRQUNIekIsS0FBS3NDOzs7OzRHQ3RDYixNQUFBQyxFQUFBekUsaUJBQUEsbUJBQ0EwRSxFQUFBMUUsZ0JBQUEsa0JBTUEsSUFBSTJFLEVBSlNuRixFQUFBMkUsY0FBZ0IsU0FDaEIzRSxFQUFBb0YsWUFBYyxPQUNkcEYsRUFBQXFGLGNBQWdCLFNBRzdCLElBQUlDLE9BQWtDLEVBU3pCdEYsRUFBQXVGLEdBQU0sV0FDZixJQUNJQyxFQUFJLEVBQ0pDLEVBQU1DLFNBQVNDLGNBQWMsT0FDN0JDLEVBQU1ILEVBQUlJLHFCQUFxQixLQUVuQyxLQUNJSixFQUFJSyxVQUFZLHVCQUFzQk4sRUFBSywyQkFDM0NJLEVBQUksS0FHUixPQUFPSixFQUFJLEVBQUlBLE9BVlhPLEVBRFUsR0FjbEIvRixFQUFBZ0csVUFBQSxNQVNJN0IsWUFBb0JyRSxFQUFjbUcsR0FnQjlCLEdBaEJnQnZELEtBQUE1QyxPQUFjNEMsS0FBQXVELE1BUjNCdkQsS0FBQWdDLE9BQWlCMUUsRUFBQTJFLGNBQ2pCakMsS0FBQXdELFFBQVUsU0FDVHhELEtBQUF5RCxPQUFtQixHQUNuQnpELEtBQUEwRCxTQUFtQixJQUVuQjFELEtBQUEyRCxnQkFBaUIsT0FLRyxJQUFwQjNELEtBQUt1RCxJQUFJSyxRQUNUbkIsRUFBYSxTQUNiRyxFQUEwQix5QkFDTyxJQUExQjVDLEtBQUt1RCxJQUFlLFdBQzNCZCxFQUFhLFlBQ2JHLEVBQTBCLDRCQUNNLElBQXpCNUMsS0FBS3VELElBQWMsVUFDMUJkLEVBQWEsV0FDYkcsRUFBMEIsMkJBQ1UsSUFBN0I1QyxLQUFLdUQsSUFBa0IsZUFDOUJkLEVBQWEsZUFDYkcsRUFBMEIsK0JBR1gsSUFBZkgsRUFDQXpDLEtBQUs2RCxpQkFDRixDQUNILE1BQU1DLEVBQWMsS0FDWjlELEtBQUt1RCxJQUFJZCxHQUNUekMsS0FBSytELE9BRUwvRCxLQUFLZ0UsU0FHYkYsSUFDQXZCLEVBQUFoQixRQUFPUCxJQUFJaEIsS0FBS3VELElBQUtYLEVBQXlCa0IsR0FFbEQ5RCxLQUFLaUUsaUJBQ0xqRSxLQUFLa0Usa0JBR1R6QyxhQUVJLEdBQUl6QixLQUFLMkQsZUFBa0IsT0FFM0IsSUFBSVEsRUFBYSxPQUdiN0csRUFBQXVGLEdBQUssSUFDTHNCLEVBQWEsWUFHakI1QixFQUFBaEIsUUFBT1AsSUFBSWhCLEtBQUs1QyxLQUFNK0csRUFBWSxLQUM5QkMsUUFBUUMsSUFBSSxXQUNMckUsS0FBSytELFNBR2hCeEIsRUFBQWhCLFFBQU9QLElBQUloQixLQUFLNUMsS0FYRSxRQVdpQixJQUN4QjRDLEtBQUtnRSxTQUdoQmhFLEtBQUsyRCxnQkFBaUIsRUFHMUJsQyxlQUFlbEIsR0FHUEEsYUFBaUIrRCxZQUFrQyxJQUFwQi9ELEVBQU1nRSxXQUF1QyxJQUFwQmhFLEVBQU1pRSxZQUlsRXhFLEtBQUt5RCxPQUFPZ0IsSUFBSUMsY0FDaEIxRSxLQUFLeUQsT0FBT2tCLE9BQVMsRUFFakIzRSxLQUFLZ0MsU0FBVzFFLEVBQUFvRixhQUNoQjFDLEtBQUs0RSxTQUdUNUUsS0FBSzZFLGlCQUFtQixJQUFLQyxLQUU3QjlFLEtBQUt5RCxPQUFPaEQsS0FBS3NFLFdBQVcsS0FDeEIsR0FBSS9FLEtBQUtnQyxTQUFXMUUsRUFBQTJFLGVBQWlCakMsS0FBS2dDLFNBQVcxRSxFQUFBcUYsY0FDakQsT0FBTzNDLEtBQUtnRixRQUVqQmhGLEtBQUswRCxZQUdaakMsa0JBQ0ljLEVBQUFoQixRQUFPUCxJQUFJaEIsS0FBS3VELElBQUssWUFBYXZELEtBQUtpRSxlQUFlMUUsS0FBS1MsT0FDM0R1QyxFQUFBaEIsUUFBT1AsSUFBSWhCLEtBQUt1RCxJQUFLLFlBQWF2RCxLQUFLaUUsZUFBZTFFLEtBQUtTLE9BQzNEdUMsRUFBQWhCLFFBQU9QLElBQUloQixLQUFLdUQsSUFBSyxRQUFTdkQsS0FBS2lFLGVBQWUxRSxLQUFLUyxPQUN2RHVDLEVBQUFoQixRQUFPUCxJQUFJaEIsS0FBS3VELElBQUssYUFBY3ZELEtBQUtpRSxlQUFlMUUsS0FBS1MsT0FDNUR1QyxFQUFBaEIsUUFBT1AsSUFBSWhCLEtBQUs1QyxLQUFNLFNBQVU0QyxLQUFLaUUsZUFBZTFFLEtBQUtTLE9BRXpEQSxLQUFLZ0UsTUFBTWhFLEtBQUtpRSxlQUFlMUUsS0FBS1MsT0FHeEN5QixHQUFHbEIsRUFBZUMsR0FFZCxPQURBK0IsRUFBQWhCLFFBQU9qQixPQUFPQyxFQUFPQyxHQUNkUixLQUdYeUIsSUFBSWxCLEVBQWVDLEdBRWYsT0FEQStCLEVBQUFoQixRQUFPVixPQUFPTixFQUFPQyxHQUNkUixLQUdYeUIsZ0JBQWdCRSxHQUdaLE9BRkEzQixLQUFLMEQsU0FBcUIsSUFBVi9CLEVBQ2hCM0IsS0FBS2lFLGlCQUNFakUsS0FHWHlCLGtCQUNJLE9BQU96QixLQUFLMEQsU0FHaEJqQyxjQUNJLElBQ0l3RCxFQURBQyxHQUFPLElBQUtKLEtBRWhCLEdBQUk5RSxLQUFLZ0MsU0FBVzFFLEVBQUFvRixZQUNoQnVDLEVBQU0sQ0FDRkUsUUFBUSxFQUNSQyxRQUFTRixFQUFNbEYsS0FBSzZFLGdCQUNwQlEsU0FBVSxFQUNWQyxZQUFhLFNBRWQsQ0FDSCxJQUFJRCxFQUFZckYsS0FBSzZFLGdCQUFrQjdFLEtBQUswRCxTQUFZd0IsRUFDeERELEVBQU0sQ0FDRkUsUUFBUSxFQUNSQyxRQUFTRixFQUFNbEYsS0FBSzZFLGdCQUNwQlEsV0FDQUMsWUFBYUMsWUFBWSxJQUFrQixJQUFYRixFQUFpQnJGLEtBQUswRCxVQUFXOEIsUUFBUSxLQUdqRixPQUFPUCxFQUdYeEQsS0FBS2pCLEdBUUQsT0FQSUEsRUFDQVIsS0FBSzhCLEdBQUcsT0FBUXRCLElBRWhCUixLQUFLZ0MsT0FBUzFFLEVBQUFvRixZQUNkSCxFQUFBaEIsUUFBT2IsS0FBSyxRQUNaNkIsRUFBQWhCLFFBQU9iLEtBQUssZ0JBQWlCLENBQUMsQ0FBRXNCLE9BQVFoQyxLQUFLZ0MsV0FFMUNoQyxLQUdYeUIsS0FBS2pCLEdBUUQsT0FQSUEsRUFDQVIsS0FBSzhCLEdBQUcsT0FBUXRCLElBRWhCUixLQUFLZ0MsT0FBUzFFLEVBQUFxRixjQUNkSixFQUFBaEIsUUFBT2IsS0FBSyxRQUNaNkIsRUFBQWhCLFFBQU9iLEtBQUssZ0JBQWlCLENBQUMsQ0FBRXNCLE9BQVFoQyxLQUFLZ0MsV0FFMUNoQyxLQUdYeUIsTUFBTWpCLEdBU0YsT0FSSUEsRUFDQVIsS0FBSzhCLEdBQUcsUUFBU3RCLEdBQ1ZSLEtBQUtnQyxTQUFXMUUsRUFBQTJFLGdCQUN2QmpDLEtBQUtnQyxPQUFTMUUsRUFBQTJFLGNBQ2RNLEVBQUFoQixRQUFPYixLQUFLLFNBQ1o2QixFQUFBaEIsUUFBT2IsS0FBSyxVQUNaNkIsRUFBQWhCLFFBQU9iLEtBQUssZ0JBQWlCLENBQUMsQ0FBRXNCLE9BQVFoQyxLQUFLZ0MsV0FFMUNoQyxLQUdYeUIsT0FBT2pCLEdBUUgsT0FQSUEsRUFDQVIsS0FBSzhCLEdBQUcsU0FBVXRCLEdBQ1hSLEtBQUtnQyxTQUFXMUUsRUFBQTJFLGdCQUN2QmpDLEtBQUtnQyxPQUFTMUUsRUFBQTJFLGNBQ2RNLEVBQUFoQixRQUFPYixLQUFLLFVBQ1o2QixFQUFBaEIsUUFBT2IsS0FBSyxnQkFBaUIsQ0FBQyxDQUFFc0IsT0FBUWhDLEtBQUtnQyxXQUUxQ2hDLEtBR1h5QixRQUFRRSxFQUFpQm5CLEdBQ3JCLE9BQU8sSUFBSWdDLEVBQUFqQixRQUFNdkIsS0FBTTJCLEVBQVNuQixHQUdwQ2lCLElBQUlnRSxHQUNBLFlBQWMsSUFBVkEsRUFDT3pGLEtBQUtnQyxTQUFXeUQsRUFFaEJ6RixLQUFLZ0MsU0FBVzFFLEVBQUEyRTs7Ozt5SENoT25DLE1BQUFULEVBQUExRCxvQkFBQSxzQkFJTVYsRUFBdUIsaUJBQVRzSSxNQUFxQkEsS0FBS0EsT0FBU0EsTUFBUUEsTUFDaEMsaUJBQVhDLEdBQXVCQSxFQUFPQSxTQUFXQSxHQUFVQSxHQUMxRDNGLEtBRUExQyxFQUFBb0UsVUFBWSxJQUFJRixFQUFBOEIsVUFBVWxHLEVBQU00RiIsImZpbGUiOiJpZnZpc2libGUuanMiLCJzb3VyY2VzQ29udGVudCI6WyIoZnVuY3Rpb24gd2VicGFja1VuaXZlcnNhbE1vZHVsZURlZmluaXRpb24ocm9vdCwgZmFjdG9yeSkge1xuXHRpZih0eXBlb2YgZXhwb3J0cyA9PT0gJ29iamVjdCcgJiYgdHlwZW9mIG1vZHVsZSA9PT0gJ29iamVjdCcpXG5cdFx0bW9kdWxlLmV4cG9ydHMgPSBmYWN0b3J5KCk7XG5cdGVsc2UgaWYodHlwZW9mIGRlZmluZSA9PT0gJ2Z1bmN0aW9uJyAmJiBkZWZpbmUuYW1kKVxuXHRcdGRlZmluZShbXSwgZmFjdG9yeSk7XG5cdGVsc2Uge1xuXHRcdHZhciBhID0gZmFjdG9yeSgpO1xuXHRcdGZvcih2YXIgaSBpbiBhKSAodHlwZW9mIGV4cG9ydHMgPT09ICdvYmplY3QnID8gZXhwb3J0cyA6IHJvb3QpW2ldID0gYVtpXTtcblx0fVxufSkod2luZG93LCBmdW5jdGlvbigpIHtcbnJldHVybiAiLCIgXHQvLyBUaGUgbW9kdWxlIGNhY2hlXG4gXHR2YXIgaW5zdGFsbGVkTW9kdWxlcyA9IHt9O1xuXG4gXHQvLyBUaGUgcmVxdWlyZSBmdW5jdGlvblxuIFx0ZnVuY3Rpb24gX193ZWJwYWNrX3JlcXVpcmVfXyhtb2R1bGVJZCkge1xuXG4gXHRcdC8vIENoZWNrIGlmIG1vZHVsZSBpcyBpbiBjYWNoZVxuIFx0XHRpZihpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXSkge1xuIFx0XHRcdHJldHVybiBpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXS5leHBvcnRzO1xuIFx0XHR9XG4gXHRcdC8vIENyZWF0ZSBhIG5ldyBtb2R1bGUgKGFuZCBwdXQgaXQgaW50byB0aGUgY2FjaGUpXG4gXHRcdHZhciBtb2R1bGUgPSBpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXSA9IHtcbiBcdFx0XHRpOiBtb2R1bGVJZCxcbiBcdFx0XHRsOiBmYWxzZSxcbiBcdFx0XHRleHBvcnRzOiB7fVxuIFx0XHR9O1xuXG4gXHRcdC8vIEV4ZWN1dGUgdGhlIG1vZHVsZSBmdW5jdGlvblxuIFx0XHRtb2R1bGVzW21vZHVsZUlkXS5jYWxsKG1vZHVsZS5leHBvcnRzLCBtb2R1bGUsIG1vZHVsZS5leHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKTtcblxuIFx0XHQvLyBGbGFnIHRoZSBtb2R1bGUgYXMgbG9hZGVkXG4gXHRcdG1vZHVsZS5sID0gdHJ1ZTtcblxuIFx0XHQvLyBSZXR1cm4gdGhlIGV4cG9ydHMgb2YgdGhlIG1vZHVsZVxuIFx0XHRyZXR1cm4gbW9kdWxlLmV4cG9ydHM7XG4gXHR9XG5cblxuIFx0Ly8gZXhwb3NlIHRoZSBtb2R1bGVzIG9iamVjdCAoX193ZWJwYWNrX21vZHVsZXNfXylcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubSA9IG1vZHVsZXM7XG5cbiBcdC8vIGV4cG9zZSB0aGUgbW9kdWxlIGNhY2hlXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLmMgPSBpbnN0YWxsZWRNb2R1bGVzO1xuXG4gXHQvLyBkZWZpbmUgZ2V0dGVyIGZ1bmN0aW9uIGZvciBoYXJtb255IGV4cG9ydHNcbiBcdF9fd2VicGFja19yZXF1aXJlX18uZCA9IGZ1bmN0aW9uKGV4cG9ydHMsIG5hbWUsIGdldHRlcikge1xuIFx0XHRpZighX193ZWJwYWNrX3JlcXVpcmVfXy5vKGV4cG9ydHMsIG5hbWUpKSB7XG4gXHRcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIG5hbWUsIHsgZW51bWVyYWJsZTogdHJ1ZSwgZ2V0OiBnZXR0ZXIgfSk7XG4gXHRcdH1cbiBcdH07XG5cbiBcdC8vIGRlZmluZSBfX2VzTW9kdWxlIG9uIGV4cG9ydHNcbiBcdF9fd2VicGFja19yZXF1aXJlX18uciA9IGZ1bmN0aW9uKGV4cG9ydHMpIHtcbiBcdFx0aWYodHlwZW9mIFN5bWJvbCAhPT0gJ3VuZGVmaW5lZCcgJiYgU3ltYm9sLnRvU3RyaW5nVGFnKSB7XG4gXHRcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFN5bWJvbC50b1N0cmluZ1RhZywgeyB2YWx1ZTogJ01vZHVsZScgfSk7XG4gXHRcdH1cbiBcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICdfX2VzTW9kdWxlJywgeyB2YWx1ZTogdHJ1ZSB9KTtcbiBcdH07XG5cbiBcdC8vIGNyZWF0ZSBhIGZha2UgbmFtZXNwYWNlIG9iamVjdFxuIFx0Ly8gbW9kZSAmIDE6IHZhbHVlIGlzIGEgbW9kdWxlIGlkLCByZXF1aXJlIGl0XG4gXHQvLyBtb2RlICYgMjogbWVyZ2UgYWxsIHByb3BlcnRpZXMgb2YgdmFsdWUgaW50byB0aGUgbnNcbiBcdC8vIG1vZGUgJiA0OiByZXR1cm4gdmFsdWUgd2hlbiBhbHJlYWR5IG5zIG9iamVjdFxuIFx0Ly8gbW9kZSAmIDh8MTogYmVoYXZlIGxpa2UgcmVxdWlyZVxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy50ID0gZnVuY3Rpb24odmFsdWUsIG1vZGUpIHtcbiBcdFx0aWYobW9kZSAmIDEpIHZhbHVlID0gX193ZWJwYWNrX3JlcXVpcmVfXyh2YWx1ZSk7XG4gXHRcdGlmKG1vZGUgJiA4KSByZXR1cm4gdmFsdWU7XG4gXHRcdGlmKChtb2RlICYgNCkgJiYgdHlwZW9mIHZhbHVlID09PSAnb2JqZWN0JyAmJiB2YWx1ZSAmJiB2YWx1ZS5fX2VzTW9kdWxlKSByZXR1cm4gdmFsdWU7XG4gXHRcdHZhciBucyA9IE9iamVjdC5jcmVhdGUobnVsbCk7XG4gXHRcdF9fd2VicGFja19yZXF1aXJlX18ucihucyk7XG4gXHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShucywgJ2RlZmF1bHQnLCB7IGVudW1lcmFibGU6IHRydWUsIHZhbHVlOiB2YWx1ZSB9KTtcbiBcdFx0aWYobW9kZSAmIDIgJiYgdHlwZW9mIHZhbHVlICE9ICdzdHJpbmcnKSBmb3IodmFyIGtleSBpbiB2YWx1ZSkgX193ZWJwYWNrX3JlcXVpcmVfXy5kKG5zLCBrZXksIGZ1bmN0aW9uKGtleSkgeyByZXR1cm4gdmFsdWVba2V5XTsgfS5iaW5kKG51bGwsIGtleSkpO1xuIFx0XHRyZXR1cm4gbnM7XG4gXHR9O1xuXG4gXHQvLyBnZXREZWZhdWx0RXhwb3J0IGZ1bmN0aW9uIGZvciBjb21wYXRpYmlsaXR5IHdpdGggbm9uLWhhcm1vbnkgbW9kdWxlc1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5uID0gZnVuY3Rpb24obW9kdWxlKSB7XG4gXHRcdHZhciBnZXR0ZXIgPSBtb2R1bGUgJiYgbW9kdWxlLl9fZXNNb2R1bGUgP1xuIFx0XHRcdGZ1bmN0aW9uIGdldERlZmF1bHQoKSB7IHJldHVybiBtb2R1bGVbJ2RlZmF1bHQnXTsgfSA6XG4gXHRcdFx0ZnVuY3Rpb24gZ2V0TW9kdWxlRXhwb3J0cygpIHsgcmV0dXJuIG1vZHVsZTsgfTtcbiBcdFx0X193ZWJwYWNrX3JlcXVpcmVfXy5kKGdldHRlciwgJ2EnLCBnZXR0ZXIpO1xuIFx0XHRyZXR1cm4gZ2V0dGVyO1xuIFx0fTtcblxuIFx0Ly8gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm8gPSBmdW5jdGlvbihvYmplY3QsIHByb3BlcnR5KSB7IHJldHVybiBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwob2JqZWN0LCBwcm9wZXJ0eSk7IH07XG5cbiBcdC8vIF9fd2VicGFja19wdWJsaWNfcGF0aF9fXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnAgPSBcIlwiO1xuXG5cbiBcdC8vIExvYWQgZW50cnkgbW9kdWxlIGFuZCByZXR1cm4gZXhwb3J0c1xuIFx0cmV0dXJuIF9fd2VicGFja19yZXF1aXJlX18oX193ZWJwYWNrX3JlcXVpcmVfXy5zID0gMCk7XG4iLCJ2YXIgZztcblxuLy8gVGhpcyB3b3JrcyBpbiBub24tc3RyaWN0IG1vZGVcbmcgPSAoZnVuY3Rpb24oKSB7XG5cdHJldHVybiB0aGlzO1xufSkoKTtcblxudHJ5IHtcblx0Ly8gVGhpcyB3b3JrcyBpZiBldmFsIGlzIGFsbG93ZWQgKHNlZSBDU1ApXG5cdGcgPSBnIHx8IG5ldyBGdW5jdGlvbihcInJldHVybiB0aGlzXCIpKCk7XG59IGNhdGNoIChlKSB7XG5cdC8vIFRoaXMgd29ya3MgaWYgdGhlIHdpbmRvdyByZWZlcmVuY2UgaXMgYXZhaWxhYmxlXG5cdGlmICh0eXBlb2Ygd2luZG93ID09PSBcIm9iamVjdFwiKSBnID0gd2luZG93O1xufVxuXG4vLyBnIGNhbiBzdGlsbCBiZSB1bmRlZmluZWQsIGJ1dCBub3RoaW5nIHRvIGRvIGFib3V0IGl0Li4uXG4vLyBXZSByZXR1cm4gdW5kZWZpbmVkLCBpbnN0ZWFkIG9mIG5vdGhpbmcgaGVyZSwgc28gaXQnc1xuLy8gZWFzaWVyIHRvIGhhbmRsZSB0aGlzIGNhc2UuIGlmKCFnbG9iYWwpIHsgLi4ufVxuXG5tb2R1bGUuZXhwb3J0cyA9IGc7XG4iLCJleHBvcnQgbmFtZXNwYWNlIEV2ZW50cyB7XG4gICAgY29uc3Qgc3RvcmUgPSB7fTtcbiAgICBsZXQgc2V0TGlzdGVuZXI6IEZ1bmN0aW9uO1xuXG4gICAgZXhwb3J0IGZ1bmN0aW9uIGF0dGFjaChldmVudDogc3RyaW5nLCBjYWxsYmFjazogRnVuY3Rpb24pIHtcbiAgICAgICAgaWYgKCFzdG9yZVtldmVudF0pIHtcbiAgICAgICAgICAgIHN0b3JlW2V2ZW50XSA9IFtdO1xuICAgICAgICB9XG4gICAgICAgIHN0b3JlW2V2ZW50XS5wdXNoKGNhbGxiYWNrKTtcbiAgICB9XG5cbiAgICBleHBvcnQgZnVuY3Rpb24gZmlyZShldmVudDogc3RyaW5nLCBhcmdzID0gW10pIHtcbiAgICAgICAgaWYgKHN0b3JlW2V2ZW50XSkge1xuICAgICAgICAgICAgc3RvcmVbZXZlbnRdLmZvckVhY2goKGNhbGxiYWNrKSA9PiB7XG4gICAgICAgICAgICAgICAgY2FsbGJhY2soLi4uYXJncyk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIGV4cG9ydCBmdW5jdGlvbiByZW1vdmUoZXZlbnQ6IHN0cmluZywgY2FsbGJhY2s/OiBGdW5jdGlvbikge1xuICAgICAgICBpZiAoIWNhbGxiYWNrKSB7XG4gICAgICAgICAgICBkZWxldGUgc3RvcmVbZXZlbnRdO1xuICAgICAgICB9XG4gICAgICAgIGlmIChzdG9yZVtldmVudF0pIHtcbiAgICAgICAgICAgIHN0b3JlW2V2ZW50XSA9IHN0b3JlW2V2ZW50XS5maWx0ZXIoKHNhdmVkQ2FsbGJhY2spID0+IHtcbiAgICAgICAgICAgICAgICByZXR1cm4gY2FsbGJhY2sgIT09IHNhdmVkQ2FsbGJhY2s7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIGV4cG9ydCBmdW5jdGlvbiBkb20oZWxlbWVudDogYW55LCBldmVudDogc3RyaW5nLCBjYWxsYmFjazogRnVuY3Rpb24pIHtcbiAgICAgICAgaWYgKCFzZXRMaXN0ZW5lcikge1xuICAgICAgICAgICAgaWYgKGVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcikge1xuICAgICAgICAgICAgICAgIHNldExpc3RlbmVyID0gZnVuY3Rpb24gKGVsLCBldiwgZm4pIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGVsLmFkZEV2ZW50TGlzdGVuZXIoZXYsIGZuLCBmYWxzZSk7XG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAodHlwZW9mIGVsZW1lbnRbXCJhdHRhY2hFdmVudFwiXSA9PT0gXCJmdW5jdGlvblwiKSB7XG4gICAgICAgICAgICAgICAgc2V0TGlzdGVuZXIgPSBmdW5jdGlvbiAoZWwsIGV2LCBmbikge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZWwuYXR0YWNoRXZlbnQoXCJvblwiICsgZXYsIGZuLCBmYWxzZSk7XG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgc2V0TGlzdGVuZXIgPSBmdW5jdGlvbiAoZWwsIGV2LCBmbikge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZWxbXCJvblwiICsgZXZdID0gZm47XG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gc2V0TGlzdGVuZXIoZWxlbWVudCwgZXZlbnQsIGNhbGxiYWNrKTtcbiAgICB9XG59XG5cbmV4cG9ydCBkZWZhdWx0IEV2ZW50cztcbiIsImltcG9ydCB7IElmVmlzaWJsZSwgU1RBVFVTX0FDVElWRSB9IGZyb20gXCIuL2lmdmlzaWJsZVwiO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBUaW1lciB7XG4gICAgcHJpdmF0ZSB0b2tlbjogbnVtYmVyO1xuICAgIHN0b3BwZWQ6IGJvb2xlYW4gPSBmYWxzZTtcblxuICAgIGNvbnN0cnVjdG9yKHByaXZhdGUgaWZ2aXNpYmxlOiBJZlZpc2libGUsXG4gICAgICAgICAgICAgICAgcHJpdmF0ZSBzZWNvbmRzOiBudW1iZXIsXG4gICAgICAgICAgICAgICAgcHJpdmF0ZSBjYWxsYmFjazogRnVuY3Rpb24pIHtcbiAgICAgICAgdGhpcy5zdGFydCgpO1xuXG4gICAgICAgIHRoaXMuaWZ2aXNpYmxlLm9uKFwic3RhdHVzQ2hhbmdlZFwiLCAoZGF0YTogYW55KSA9PiB7XG4gICAgICAgICAgICBpZiAodGhpcy5zdG9wcGVkID09PSBmYWxzZSkge1xuICAgICAgICAgICAgICAgIGlmIChkYXRhLnN0YXR1cyA9PT0gU1RBVFVTX0FDVElWRSkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnN0YXJ0KCk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wYXVzZSgpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBzdGFydCgpIHtcbiAgICAgICAgdGhpcy5zdG9wcGVkID0gZmFsc2U7XG4gICAgICAgIGNsZWFySW50ZXJ2YWwodGhpcy50b2tlbik7XG4gICAgICAgIHRoaXMudG9rZW4gPSBzZXRJbnRlcnZhbCh0aGlzLmNhbGxiYWNrLCB0aGlzLnNlY29uZHMgKiAxMDAwKTtcbiAgICB9XG5cbiAgICBwdWJsaWMgc3RvcCgpIHtcbiAgICAgICAgdGhpcy5zdG9wcGVkID0gdHJ1ZTtcbiAgICAgICAgY2xlYXJJbnRlcnZhbCh0aGlzLnRva2VuKTtcbiAgICB9XG5cbiAgICBwdWJsaWMgcmVzdW1lKCkge1xuICAgICAgICB0aGlzLnN0YXJ0KCk7XG4gICAgfVxuXG4gICAgcHVibGljIHBhdXNlKCkge1xuICAgICAgICB0aGlzLnN0b3AoKTtcbiAgICB9XG59XG4iLCJpbXBvcnQgRXZlbnRzIGZyb20gXCIuL0V2ZW50c1wiO1xuaW1wb3J0IFRpbWVyIGZyb20gXCIuL1RpbWVyXCI7XG5cbmV4cG9ydCBjb25zdCBTVEFUVVNfQUNUSVZFID0gXCJhY3RpdmVcIjtcbmV4cG9ydCBjb25zdCBTVEFUVVNfSURMRSA9IFwiaWRsZVwiO1xuZXhwb3J0IGNvbnN0IFNUQVRVU19ISURERU4gPSBcImhpZGRlblwiO1xuLy8gZGVjbGFyZSB2YXIgX19WRVJTSU9OX186IHN0cmluZztcbmxldCBET0NfSElEREVOOiBzdHJpbmc7XG5sZXQgVklTSUJJTElUWV9DSEFOR0VfRVZFTlQ6IHN0cmluZyA9IHZvaWQgMDtcblxuZXhwb3J0IGludGVyZmFjZSBJZGxlSW5mbyB7XG4gICAgaXNJZGxlOiBib29sZWFuO1xuICAgIGlkbGVGb3I6IG51bWJlcjtcbiAgICB0aW1lTGVmdDogbnVtYmVyO1xuICAgIHRpbWVMZWZ0UGVyOiBudW1iZXI7XG59XG5cbmV4cG9ydCBjb25zdCBJRSA9IChmdW5jdGlvbiAoKSB7XG4gICAgbGV0IHVuZGVmLFxuICAgICAgICB2ID0gMyxcbiAgICAgICAgZGl2ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKSxcbiAgICAgICAgYWxsID0gZGl2LmdldEVsZW1lbnRzQnlUYWdOYW1lKFwiaVwiKTtcblxuICAgIHdoaWxlIChcbiAgICAgICAgZGl2LmlubmVySFRNTCA9IFwiPCEtLVtpZiBndCBJRSBcIiArICgrK3YpICsgXCJdPjxpPjwvaT48IVtlbmRpZl0tLT5cIixcbiAgICAgICAgYWxsWzBdXG4gICAgKTtcblxuICAgIHJldHVybiB2ID4gNCA/IHYgOiB1bmRlZjtcbn0oKSk7XG5cbmV4cG9ydCBjbGFzcyBJZlZpc2libGUge1xuICAgIHB1YmxpYyBzdGF0dXM6IHN0cmluZyA9IFNUQVRVU19BQ1RJVkU7XG4gICAgcHVibGljIFZFUlNJT04gPSBcIjIuMC4xMVwiO1xuICAgIHByaXZhdGUgdGltZXJzOiBudW1iZXJbXSA9IFtdO1xuICAgIHByaXZhdGUgaWRsZVRpbWU6IG51bWJlciA9IDMwMDAwO1xuICAgIHByaXZhdGUgaWRsZVN0YXJ0ZWRUaW1lOiBudW1iZXI7XG4gICAgcHJpdmF0ZSBpc0xlZ2FjeU1vZGVPbiA9IGZhbHNlO1xuXG5cbiAgICBjb25zdHJ1Y3Rvcihwcml2YXRlIHJvb3QsIHByaXZhdGUgZG9jKSB7XG4gICAgICAgIC8vIEZpbmQgY29ycmVjdCBicm93c2VyIGV2ZW50c1xuICAgICAgICBpZiAodGhpcy5kb2MuaGlkZGVuICE9PSB2b2lkIDApIHtcbiAgICAgICAgICAgIERPQ19ISURERU4gPSBcImhpZGRlblwiO1xuICAgICAgICAgICAgVklTSUJJTElUWV9DSEFOR0VfRVZFTlQgPSBcInZpc2liaWxpdHljaGFuZ2VcIjtcbiAgICAgICAgfSBlbHNlIGlmICh0aGlzLmRvY1tcIm1vekhpZGRlblwiXSAhPT0gdm9pZCAwKSB7XG4gICAgICAgICAgICBET0NfSElEREVOID0gXCJtb3pIaWRkZW5cIjtcbiAgICAgICAgICAgIFZJU0lCSUxJVFlfQ0hBTkdFX0VWRU5UID0gXCJtb3p2aXNpYmlsaXR5Y2hhbmdlXCI7XG4gICAgICAgIH0gZWxzZSBpZiAodGhpcy5kb2NbXCJtc0hpZGRlblwiXSAhPT0gdm9pZCAwKSB7XG4gICAgICAgICAgICBET0NfSElEREVOID0gXCJtc0hpZGRlblwiO1xuICAgICAgICAgICAgVklTSUJJTElUWV9DSEFOR0VfRVZFTlQgPSBcIm1zdmlzaWJpbGl0eWNoYW5nZVwiO1xuICAgICAgICB9IGVsc2UgaWYgKHRoaXMuZG9jW1wid2Via2l0SGlkZGVuXCJdICE9PSB2b2lkIDApIHtcbiAgICAgICAgICAgIERPQ19ISURERU4gPSBcIndlYmtpdEhpZGRlblwiO1xuICAgICAgICAgICAgVklTSUJJTElUWV9DSEFOR0VfRVZFTlQgPSBcIndlYmtpdHZpc2liaWxpdHljaGFuZ2VcIjtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChET0NfSElEREVOID09PSB2b2lkIDApIHtcbiAgICAgICAgICAgIHRoaXMubGVnYWN5TW9kZSgpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgY29uc3QgdHJhY2tDaGFuZ2UgPSAoKSA9PiB7XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuZG9jW0RPQ19ISURERU5dKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuYmx1cigpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZm9jdXMoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgdHJhY2tDaGFuZ2UoKTsgLy8gZ2V0IGluaXRpYWwgc3RhdHVzXG4gICAgICAgICAgICBFdmVudHMuZG9tKHRoaXMuZG9jLCBWSVNJQklMSVRZX0NIQU5HRV9FVkVOVCwgdHJhY2tDaGFuZ2UpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuc3RhcnRJZGxlVGltZXIoKTtcbiAgICAgICAgdGhpcy50cmFja0lkbGVTdGF0dXMoKTtcbiAgICB9XG5cbiAgICBsZWdhY3lNb2RlKCkge1xuICAgICAgICAvLyBpdCdzIGFscmVhZHkgb25cbiAgICAgICAgaWYgKHRoaXMuaXNMZWdhY3lNb2RlT24pIHsgcmV0dXJuOyB9XG5cbiAgICAgICAgbGV0IEJMVVJfRVZFTlQgPSBcImJsdXJcIjtcbiAgICAgICAgbGV0IEZPQ1VTX0VWRU5UID0gXCJmb2N1c1wiO1xuXG4gICAgICAgIGlmIChJRSA8IDkpIHtcbiAgICAgICAgICAgIEJMVVJfRVZFTlQgPSBcImZvY3Vzb3V0XCI7XG4gICAgICAgIH1cblxuICAgICAgICBFdmVudHMuZG9tKHRoaXMucm9vdCwgQkxVUl9FVkVOVCwgKCkgPT4ge1xuICAgICAgICAgICAgY29uc29sZS5sb2coXCJibHVycmVkXCIpO1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuYmx1cigpO1xuICAgICAgICB9KTtcblxuICAgICAgICBFdmVudHMuZG9tKHRoaXMucm9vdCwgRk9DVVNfRVZFTlQsICgpID0+IHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmZvY3VzKCk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIHRoaXMuaXNMZWdhY3lNb2RlT24gPSB0cnVlO1xuICAgIH1cblxuICAgIHN0YXJ0SWRsZVRpbWVyKGV2ZW50PzogRXZlbnQpIHtcbiAgICAgICAgLy8gUHJldmVudHMgUGhhbnRvbSBldmVudHMuXG4gICAgICAgIC8vIEBzZWUgaHR0cHM6Ly9naXRodWIuY29tL3NlcmthbnllcnNlbi9pZnZpc2libGUuanMvcHVsbC8zN1xuICAgICAgICBpZiAoZXZlbnQgaW5zdGFuY2VvZiBNb3VzZUV2ZW50ICYmIGV2ZW50Lm1vdmVtZW50WCA9PT0gMCAmJiBldmVudC5tb3ZlbWVudFkgPT09IDApIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMudGltZXJzLm1hcChjbGVhclRpbWVvdXQpO1xuICAgICAgICB0aGlzLnRpbWVycy5sZW5ndGggPSAwOyAvLyBjbGVhciB0aGUgYXJyYXlcblxuICAgICAgICBpZiAodGhpcy5zdGF0dXMgPT09IFNUQVRVU19JRExFKSB7XG4gICAgICAgICAgICB0aGlzLndha2V1cCgpO1xuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy5pZGxlU3RhcnRlZFRpbWUgPSArKG5ldyBEYXRlKCkpO1xuXG4gICAgICAgIHRoaXMudGltZXJzLnB1c2goc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICAgICAgICBpZiAodGhpcy5zdGF0dXMgPT09IFNUQVRVU19BQ1RJVkUgfHwgdGhpcy5zdGF0dXMgPT09IFNUQVRVU19ISURERU4pIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5pZGxlKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sIHRoaXMuaWRsZVRpbWUpKTtcbiAgICB9XG5cbiAgICB0cmFja0lkbGVTdGF0dXMoKSB7XG4gICAgICAgIEV2ZW50cy5kb20odGhpcy5kb2MsIFwibW91c2Vtb3ZlXCIsIHRoaXMuc3RhcnRJZGxlVGltZXIuYmluZCh0aGlzKSk7XG4gICAgICAgIEV2ZW50cy5kb20odGhpcy5kb2MsIFwibW91c2Vkb3duXCIsIHRoaXMuc3RhcnRJZGxlVGltZXIuYmluZCh0aGlzKSk7XG4gICAgICAgIEV2ZW50cy5kb20odGhpcy5kb2MsIFwia2V5dXBcIiwgdGhpcy5zdGFydElkbGVUaW1lci5iaW5kKHRoaXMpKTtcbiAgICAgICAgRXZlbnRzLmRvbSh0aGlzLmRvYywgXCJ0b3VjaHN0YXJ0XCIsIHRoaXMuc3RhcnRJZGxlVGltZXIuYmluZCh0aGlzKSk7XG4gICAgICAgIEV2ZW50cy5kb20odGhpcy5yb290LCBcInNjcm9sbFwiLCB0aGlzLnN0YXJ0SWRsZVRpbWVyLmJpbmQodGhpcykpO1xuICAgICAgICAvLyBXaGVuIHBhZ2UgaXMgZm9jdXMgd2l0aG91dCBhbnkgZXZlbnQsIGl0IHNob3VsZCBub3QgYmUgaWRsZS5cbiAgICAgICAgdGhpcy5mb2N1cyh0aGlzLnN0YXJ0SWRsZVRpbWVyLmJpbmQodGhpcykpO1xuICAgIH1cblxuICAgIG9uKGV2ZW50OiBzdHJpbmcsIGNhbGxiYWNrOiAoZGF0YTogYW55KSA9PiBhbnkpOiBJZlZpc2libGUge1xuICAgICAgICBFdmVudHMuYXR0YWNoKGV2ZW50LCBjYWxsYmFjayk7XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgIH1cblxuICAgIG9mZihldmVudDogc3RyaW5nLCBjYWxsYmFjaz86IGFueSk6IElmVmlzaWJsZSB7XG4gICAgICAgIEV2ZW50cy5yZW1vdmUoZXZlbnQsIGNhbGxiYWNrKTtcbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfVxuXG4gICAgc2V0SWRsZUR1cmF0aW9uKHNlY29uZHM6IG51bWJlcik6IElmVmlzaWJsZSB7XG4gICAgICAgIHRoaXMuaWRsZVRpbWUgPSBzZWNvbmRzICogMTAwMDtcbiAgICAgICAgdGhpcy5zdGFydElkbGVUaW1lcigpO1xuICAgICAgICByZXR1cm4gdGhpcztcbiAgICB9XG5cbiAgICBnZXRJZGxlRHVyYXRpb24oKTogbnVtYmVyIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuaWRsZVRpbWU7XG4gICAgfVxuXG4gICAgZ2V0SWRsZUluZm8oKTogSWRsZUluZm8ge1xuICAgICAgICBsZXQgbm93ID0gKyhuZXcgRGF0ZSgpKTtcbiAgICAgICAgbGV0IHJlczogSWRsZUluZm87XG4gICAgICAgIGlmICh0aGlzLnN0YXR1cyA9PT0gU1RBVFVTX0lETEUpIHtcbiAgICAgICAgICAgIHJlcyA9IHtcbiAgICAgICAgICAgICAgICBpc0lkbGU6IHRydWUsXG4gICAgICAgICAgICAgICAgaWRsZUZvcjogbm93IC0gdGhpcy5pZGxlU3RhcnRlZFRpbWUsXG4gICAgICAgICAgICAgICAgdGltZUxlZnQ6IDAsXG4gICAgICAgICAgICAgICAgdGltZUxlZnRQZXI6IDEwMFxuICAgICAgICAgICAgfTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGxldCB0aW1lTGVmdCA9ICh0aGlzLmlkbGVTdGFydGVkVGltZSArIHRoaXMuaWRsZVRpbWUpIC0gbm93O1xuICAgICAgICAgICAgcmVzID0ge1xuICAgICAgICAgICAgICAgIGlzSWRsZTogZmFsc2UsXG4gICAgICAgICAgICAgICAgaWRsZUZvcjogbm93IC0gdGhpcy5pZGxlU3RhcnRlZFRpbWUsXG4gICAgICAgICAgICAgICAgdGltZUxlZnQsXG4gICAgICAgICAgICAgICAgdGltZUxlZnRQZXI6IHBhcnNlRmxvYXQoKDEwMCAtICh0aW1lTGVmdCAqIDEwMCAvIHRoaXMuaWRsZVRpbWUpKS50b0ZpeGVkKDIpKVxuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gcmVzO1xuICAgIH1cblxuICAgIGlkbGUoY2FsbGJhY2s/OiAoZGF0YTogYW55KSA9PiBhbnkpOiBJZlZpc2libGUge1xuICAgICAgICBpZiAoY2FsbGJhY2spIHtcbiAgICAgICAgICAgIHRoaXMub24oXCJpZGxlXCIsIGNhbGxiYWNrKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMuc3RhdHVzID0gU1RBVFVTX0lETEU7XG4gICAgICAgICAgICBFdmVudHMuZmlyZShcImlkbGVcIik7XG4gICAgICAgICAgICBFdmVudHMuZmlyZShcInN0YXR1c0NoYW5nZWRcIiwgW3sgc3RhdHVzOiB0aGlzLnN0YXR1cyB9XSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfVxuXG4gICAgYmx1cihjYWxsYmFjaz86IChkYXRhOiBhbnkpID0+IGFueSk6IElmVmlzaWJsZSB7XG4gICAgICAgIGlmIChjYWxsYmFjaykge1xuICAgICAgICAgICAgdGhpcy5vbihcImJsdXJcIiwgY2FsbGJhY2spO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5zdGF0dXMgPSBTVEFUVVNfSElEREVOO1xuICAgICAgICAgICAgRXZlbnRzLmZpcmUoXCJibHVyXCIpO1xuICAgICAgICAgICAgRXZlbnRzLmZpcmUoXCJzdGF0dXNDaGFuZ2VkXCIsIFt7IHN0YXR1czogdGhpcy5zdGF0dXMgfV0pO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgIH1cblxuICAgIGZvY3VzKGNhbGxiYWNrPzogKGRhdGE6IGFueSkgPT4gYW55KTogSWZWaXNpYmxlIHtcbiAgICAgICAgaWYgKGNhbGxiYWNrKSB7XG4gICAgICAgICAgICB0aGlzLm9uKFwiZm9jdXNcIiwgY2FsbGJhY2spO1xuICAgICAgICB9IGVsc2UgaWYgKHRoaXMuc3RhdHVzICE9PSBTVEFUVVNfQUNUSVZFKSB7XG4gICAgICAgICAgICB0aGlzLnN0YXR1cyA9IFNUQVRVU19BQ1RJVkU7XG4gICAgICAgICAgICBFdmVudHMuZmlyZShcImZvY3VzXCIpO1xuICAgICAgICAgICAgRXZlbnRzLmZpcmUoXCJ3YWtldXBcIik7XG4gICAgICAgICAgICBFdmVudHMuZmlyZShcInN0YXR1c0NoYW5nZWRcIiwgW3sgc3RhdHVzOiB0aGlzLnN0YXR1cyB9XSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfVxuXG4gICAgd2FrZXVwKGNhbGxiYWNrPzogKGRhdGE6IGFueSkgPT4gYW55KTogSWZWaXNpYmxlIHtcbiAgICAgICAgaWYgKGNhbGxiYWNrKSB7XG4gICAgICAgICAgICB0aGlzLm9uKFwid2FrZXVwXCIsIGNhbGxiYWNrKTtcbiAgICAgICAgfSBlbHNlIGlmICh0aGlzLnN0YXR1cyAhPT0gU1RBVFVTX0FDVElWRSkge1xuICAgICAgICAgICAgdGhpcy5zdGF0dXMgPSBTVEFUVVNfQUNUSVZFO1xuICAgICAgICAgICAgRXZlbnRzLmZpcmUoXCJ3YWtldXBcIik7XG4gICAgICAgICAgICBFdmVudHMuZmlyZShcInN0YXR1c0NoYW5nZWRcIiwgW3sgc3RhdHVzOiB0aGlzLnN0YXR1cyB9XSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfVxuXG4gICAgb25FdmVyeShzZWNvbmRzOiBudW1iZXIsIGNhbGxiYWNrOiBGdW5jdGlvbik6IFRpbWVyIHtcbiAgICAgICAgcmV0dXJuIG5ldyBUaW1lcih0aGlzLCBzZWNvbmRzLCBjYWxsYmFjayk7XG4gICAgfVxuXG4gICAgbm93KGNoZWNrPzogc3RyaW5nKTogYm9vbGVhbiB7XG4gICAgICAgIGlmIChjaGVjayAhPT0gdm9pZCAwKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5zdGF0dXMgPT09IGNoZWNrO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuc3RhdHVzID09PSBTVEFUVVNfQUNUSVZFO1xuICAgICAgICB9XG4gICAgfVxufVxuIiwiaW1wb3J0IHsgSWZWaXNpYmxlIH0gZnJvbSBcIi4vaWZ2aXNpYmxlXCI7XG5cbmRlY2xhcmUgdmFyIGdsb2JhbDogYW55O1xuLy8gZGVjaWRlIGJldHdlZW4gc2VsZiB2cyBnbG9iYWwgZGVwZW5kaW5nIG9uIHRoZSBlbnZpcm9ubWVudFxuY29uc3Qgcm9vdCA9IHR5cGVvZiBzZWxmID09PSBcIm9iamVjdFwiICYmIHNlbGYuc2VsZiA9PT0gc2VsZiAmJiBzZWxmIHx8XG4gICAgICAgICAgICAgdHlwZW9mIGdsb2JhbCA9PT0gXCJvYmplY3RcIiAmJiBnbG9iYWwuZ2xvYmFsID09PSBnbG9iYWwgJiYgZ2xvYmFsIHx8XG4gICAgICAgICAgICAgdGhpcztcblxuZXhwb3J0IGNvbnN0IGlmdmlzaWJsZSA9IG5ldyBJZlZpc2libGUocm9vdCwgZG9jdW1lbnQpO1xuIl0sInNvdXJjZVJvb3QiOiIifQ==